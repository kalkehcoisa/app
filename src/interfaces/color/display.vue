<template>
  <div
    v-if="options.formatValue"
    class="swatch no-wrap"
    v-tooltip="value"
    :style="`background-color: ${displayValue}`"
  ></div>
  <div v-else>{{ displayValue }}</div>
</template>

<script>
import mixin from "@directus/extension-toolkit/mixins/interface";
import Color from "color";

export default {
  mixins: [mixin],
  computed: {
    displayValue() {
      let value =
        this.options.output === "hex"
          ? this.value
          : Array.isArray(this.value)
          ? this.value
          : this.value.split(",");

      if (this.options.formatValue === false) {
        if (Boolean(value) === false) {
          return "";
        }

        if (this.options.output === "hex") {
          return value;
        }

        return value.join(", ");
      }

      if (this.options.output === "hex") {
        return Color(value)
          .rgb()
          .string();
      }

      try {
        return Color[this.options.output](value)
          .rgb()
          .string();
      } catch (err) {
        return null;
      }
    }
  }
};
</script>

<style scoped>
.swatch {
  width: 20px;
  height: 20px;
  border-radius: 100%;
}
</style>
